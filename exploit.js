function load_payload(filename) {
  var xhr = new XMLHttpRequest();
  xhr.open("GET", filename, true);
  xhr.responseType = "arraybuffer";

  xhr.onload = function () {
    if (xhr.status === 200) {
      var payload = new Uint8Array(xhr.response);
      window.stage2 = payload;
      // بعد ما نحمّل stage2، نرسل ملف goldhen
      send_payload("goldhen.bin");
    }
  };

  xhr.send();
}

function send_payload(filename) {
  var xhr = new XMLHttpRequest();
  xhr.open("GET", filename, true);
  xhr.responseType = "arraybuffer";

  xhr.onload = function () {
    if (xhr.status === 200) {
      var payload = new Uint8Array(xhr.response);
      // ارسال البايلود للسستم
      window.postMessage(payload, "*");
    }
  };

  xhr.send();
}

// بدء التنفيذ تلقائيًا
window.onload = function () {
  load_payload("stage2_9.00.bin");
};